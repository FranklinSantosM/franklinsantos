[
  {
    "path": "posts/2021-03-14-anova/",
    "title": "Análisis de Varianza y Prueba de Promedios en R",
    "description": "La figura de prueba de promedios de TukeyHSD es una buena opción, ya que incluye p-valor del ANVA y de la comparación de medias entre tratamientos.",
    "author": [
      {
        "name": "Franklin Santos",
        "url": "https://franklinsantos.com"
      }
    ],
    "date": "2020-11-15",
    "categories": [
      "ANOVA",
      "Post hoc",
      "Inferencial Statistic"
    ],
    "contents": "\nIntroducción\nEl análisis de varianza es una prueba estadística para determinar si dos o más medias poblacionales son diferentes entre si. En otras palabras, se usa para comparar dos o más grupos para ver si son significativamente diferentes.\nEn el resto del post lo comentaremos desde un punto de vista más práctico y en particular abordaremos los siguientes puntos:\nel objetivo del análisis de varianza y cuándo debe usarse\ncómo realizar el ANVA en R\ncómo interpretar los resultados del ANVA\ncomprender la noción de prueba de promedios e interpretar los resultados\ncómo visualizar los resultados de ANVA y pruebas de promedio\nDatos\nEl dato que se utilizará es iris, que se encuentra en la base de datos de R. Estos datos como tratamientos tienen tres especies (setosa, versicolor y virginica) y cuatro variables (Sepal.Length, Sepal.Width, Petal.Length y Petal.Width) cuantitativas\n\n\n#paquetes R a utilizar\nlibrary(tidyverse)\nlibrary(easyanova)\nlibrary(car)\nlibrary(lattice)\nlibrary(multcomp)\nlibrary(ggpubr)\nlibrary(rstatix)\n\n\n\nLa librería de easyanova es un paquete para realizar análisis de experimentos agrícolas y animales. Las funciones de esta librería son fáciles de usar. Realiza análisis en varios diseños, con datos balanceados y no balanceados.\nSalida de datos a utilizar:\n\n\n#datos\ntibble(iris)\n\n\n# A tibble: 150 x 5\n   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n          <dbl>       <dbl>        <dbl>       <dbl> <fct>  \n 1          5.1         3.5          1.4         0.2 setosa \n 2          4.9         3            1.4         0.2 setosa \n 3          4.7         3.2          1.3         0.2 setosa \n 4          4.6         3.1          1.5         0.2 setosa \n 5          5           3.6          1.4         0.2 setosa \n 6          5.4         3.9          1.7         0.4 setosa \n 7          4.6         3.4          1.4         0.3 setosa \n 8          5           3.4          1.5         0.2 setosa \n 9          4.4         2.9          1.4         0.2 setosa \n10          4.9         3.1          1.5         0.1 setosa \n# … with 140 more rows\n\n\n\n#inspección de datos\np <- ggplot(iris) +\n  aes(x = Species, y = Sepal.Width, color = Species) +\n  geom_jitter() +\n  theme(legend.position = \"none\")\n\nlibrary(plotly)\nfig <- ggplotly(p)\n\nfig\n\n\n\n{\"x\":{\"data\":[{\"x\":[0.777640529535711,1.20614191424102,1.13414816372097,1.09095564857125,1.37048771493137,0.931908190064132,1.37971688210964,0.767883115261793,1.37356221247464,1.30918436199427,1.0266430426389,1.0195543570444,0.987668373808265,1.34190563391894,1.0259136043489,0.642592507600784,0.72313800547272,0.956460146047175,0.98689306024462,0.632468907348812,0.899297484755516,0.726184121519327,1.32616886533797,0.817160544171929,0.841006673499942,1.20536491516978,1.37036766931415,0.825376521795988,0.848591803014278,1.02201912775636,0.790157722122967,0.971354461088777,1.1250799080357,0.626818666420877,0.780223679728806,0.654182387329638,0.861218596808612,1.15207113139331,1.13688632268459,0.625441245734692,0.74554249625653,1.09194862246513,1.06652112081647,0.800288302823901,1.08558353371918,0.668344919010997,1.25930271968246,1.2557179024443,0.928246599063277,1.21316787302494],\"y\":[3.50170901337638,2.98354775810614,3.22421556169167,3.07006819082424,3.56811689266935,3.86560424523428,3.39179494207725,3.40456507332623,2.90772188447416,3.06102755200118,3.70028153799474,3.42374865958467,2.96112494520843,2.96649892212823,3.99290630334988,4.43937004735693,3.87648459194228,3.50437812218443,3.8168031697534,3.81744166012853,3.37042657518759,3.72561066269875,3.60675516135991,3.29028648389503,3.40512863138691,2.96518752189353,3.41912375973538,3.49440621530637,3.42732927247882,3.17158288570121,3.10338617924601,3.39228251023218,4.1150112981908,4.1675990729034,3.07505293468013,3.22352691367269,3.49058062195778,3.62597709560767,3.03445106301457,3.38596674950793,3.53807923113927,2.31273973863572,3.18098363837227,3.4998209808208,3.81839446248487,3.02202529724687,3.77735434839502,3.1636970263347,3.69871278373525,3.30352511309087],\"text\":[\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 2.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.3<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 2.3<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.3<br />Species: setosa\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"setosa\",\"legendgroup\":\"setosa\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.88192864526063,2.21894835326821,1.81725524999201,2.01821605805308,1.78237409088761,2.35075340922922,1.71938470993191,1.9650271076709,1.74361601043493,2.2206513363868,1.71341678984463,1.87662484440953,2.0049346441403,2.32744434289634,1.74447690546513,2.08835738468915,1.98413985855877,2.3521527191624,1.85528076905757,2.1404302302748,2.33910116683692,2.17711785323918,2.1600897250697,1.82667600102723,1.92811422497034,1.9718694338575,2.17618363052607,2.18017188310623,1.6188618760556,1.69896076004952,2.32030580602586,2.36052462570369,1.60200159084052,1.9669837391004,2.23548760581762,2.34056501314044,1.77132593151182,2.05739429462701,1.79078744333237,1.88809672724456,1.75527351275086,2.15196358039975,1.76423519104719,1.89266820214689,1.90381966494024,2.18934530466795,2.22189292665571,2.21017093323171,1.64245438445359,1.79714556410909],\"y\":[3.18554594187066,3.21965003915131,3.07344224272296,2.32058827819303,2.83401517631486,2.7967186082527,3.32990760717541,2.40565790859982,2.92577909339219,2.7395958250761,1.98950148040429,2.96002031899989,2.17030265662819,2.86622568193823,2.91003072081134,3.08041724814102,3.02960637718439,2.68981643548235,2.20763857925311,2.51040271360427,3.2106544521451,2.81905850816518,2.50716527212411,2.82557834040374,2.91105990339071,2.97906388537958,2.7629112970829,3.01450126480311,2.90073614925146,2.59439382435754,2.39643513932824,2.40342303955927,2.70610372310504,2.68275056188926,3.00645201712847,3.41249740406871,3.13081881230697,2.27215245913714,2.99612287197262,2.46878457160667,2.57859245693311,3.02926684932783,2.60465688625351,2.26838650431484,2.69016850801185,3.02002379590645,2.91261622516438,2.87901089385152,2.52873443851247,2.81140949081629],\"text\":[\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,186,56,1)\"}},\"hoveron\":\"points\",\"name\":\"versicolor\",\"legendgroup\":\"versicolor\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2.73680393788964,3.32869765534997,3.11533326841891,2.60794715248048,3.05284463111311,2.73074953332543,3.11932567153126,3.20987364053726,2.8562920242548,2.73777774758637,3.31583513133228,3.08622309118509,3.0988567976281,3.37075693644583,2.95538740474731,2.75843807626516,3.25310055613518,3.36747228745371,3.08033422995359,3.21054039075971,3.18390248157084,2.61872531622648,2.80815144497901,2.89581924993545,2.80878450348973,2.62700659632683,3.37201340217143,2.82634423077106,2.72463825978339,2.61162238772958,2.95211426503956,2.91776697468013,2.77136020176113,3.0364843480289,2.76072459686548,2.98691415712237,3.03550778981298,3.26748693399131,2.68694431465119,2.91939916759729,3.32945713996887,3.13457126580179,2.78328992798924,2.62434947621077,3.25553038474172,2.90907525345683,2.81774402465671,2.91889317110181,3.17376871686429,2.92338436301798],\"y\":[3.29787336273119,2.73386696090922,3.00114287409931,2.88417381688952,3.00792852234095,2.98707547467202,2.49506788045168,2.92415682923049,2.49463644595817,3.60008052680641,3.19135230707005,2.7178095818311,2.98191102879122,2.50869183601812,2.76047558974475,3.22738498922437,3.01396964289248,3.82212835062295,2.57822027420625,2.2115132278204,3.16404158717021,2.76743402795866,2.77720152920112,2.67828659674153,3.27789730641991,3.19165820110589,2.79310903580859,3.03572468718514,2.83071814041585,3.00721119271591,2.76015721224248,3.82674165675417,2.76518767304718,2.80952575435862,2.62838606746867,2.99283941186965,3.40488186078146,3.12920513002202,3.01175968848169,3.13192838478833,3.08031917437911,3.09722172375768,2.70784049581736,3.18936891451478,3.3393070628494,2.97879927780479,2.47525968482718,2.97819240409881,3.39514876464382,2.98132692672312],\"text\":[\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.9<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.9<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.4<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.4<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(97,156,255,1)\"}},\"hoveron\":\"points\",\"name\":\"virginica\",\"legendgroup\":\"virginica\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":27.8721461187215,\"r\":7.30593607305936,\"b\":41.8264840182648,\"l\":43.1050228310502},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,3.6],\"tickmode\":\"array\",\"ticktext\":[\"setosa\",\"versicolor\",\"virginica\"],\"tickvals\":[1,2,3],\"categoryorder\":\"array\",\"categoryarray\":[\"setosa\",\"versicolor\",\"virginica\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Species\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1.86700805205666,4.56186347570457],\"tickmode\":\"array\",\"ticktext\":[\"2.0\",\"2.5\",\"3.0\",\"3.5\",\"4.0\",\"4.5\"],\"tickvals\":[2,2.5,3,3.5,4,4.5],\"categoryorder\":\"array\",\"categoryarray\":[\"2.0\",\"2.5\",\"3.0\",\"3.5\",\"4.0\",\"4.5\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Sepal.Width\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"42b537db77a4\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"42b537db77a4\",\"visdat\":{\"42b537db77a4\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\nObjetivo del ANVA\nComo se mencionó en la introducción, el ANVA se usa para comparar grupos (en la práctica, 3 o más grupos). De manera más general, se utiliza para:\nestudiar si las mediciones son similares en diferentes modalidades (también llamadas niveles o tratamientos en el contexto de ANVA) de una variable categórica\ncomparar el impacto de los diferentes niveles de una variable categórica sobre una variable cuantitativa\nexplicar una variable cuantitativa basada en una variable cualitativa\nSupuestos subyacentes de ANVA\nComo ocurre con muchas pruebas estadísticas, hay algunas suposiciones que deben cumplirse para poder interpretar los resultados. Cuando no se cumplen uno o varios supuestos, aunque técnicamente es posible realizar estas pruebas, sería incorrecto interpretar los resultados y confiar en las conclusiones.\n1. Tipo de variable\nLas variables dependientes Sepal.Length, Sepal.Width, Petal.Length y Petal.Width es una variable cuantitativa y la variable independiente Species es cualitativa (con 3 niveles correspondientes a las 3 especies). Así que tenemos una combinación de los dos tipos de variables y se cumple este supuesto.\n2. Independencia\nSe asume la independencia de las observaciones ya que los datos se han recopilado de una parte de la población seleccionada al azar y las mediciones dentro y entre las 3 muestras no están relacionadas.\nEl supuesto de independencia se verifica con mayor frecuencia con base en el diseño del experimento y en el buen control de las condiciones experimentales, como es el caso aquí. Sin embargo, si realmente desea probarlo de manera más formal, puede probarlo mediante una prueba estadística: la prueba de Durbin-Watson (en R: durbinWatsonTest(res_lm) donde res_lm es un modelo lineal). La hipótesis nula de esta prueba especifica un coeficiente de autocorrelación = 0, mientras que la hipótesis alternativa especifica un coeficiente de autocorrelación ≠ 0.\n3. Normalidad\nRecuerde que la normalidad de los residuos se puede probar visualmente mediante un histograma y un gráfico QQ, y/o formalmente mediante una prueba de normalidad (prueba de Shapiro-Wilk, por ejemplo).\nAntes de verificar el supuesto de normalidad, primero debemos calcular el ANVA. Luego guardamos los resultados en res_aov:\n\n\nres_aov <- aov(Sepal.Width ~ Species,\n  data = iris\n)\n\n\n\nAhora podemos comprobar la normalidad visualmente:\n\n\npar(mfrow = c(1, 2)) # combine plots\n\n# histogram\nhist(res_aov$residuals)\n\n# QQ-plot\nqqPlot(res_aov$residuals,\n  id = FALSE # id = FALSE to remove point identification\n)\n\n\n\n\nA partir del histograma y el gráfico QQ anteriores, ya podemos ver que el supuesto de normalidad parece cumplirse. De hecho, el histograma forma aproximadamente una curva de campana, lo que indica que los residuos siguen una distribución normal. Además, los puntos en las gráficas QQ siguen aproximadamente la línea recta y la mayoría de ellos están dentro de las bandas de confianza, lo que también indica que los residuos siguen aproximadamente una distribución normal.\nAlgunos investigadores se detienen aquí y asumen que se cumple la normalidad, mientras que otros también prueban la suposición a través de una prueba estadística formal. Es su elección probarlo (i) solo visualmente, (ii) solo a través de una prueba de normalidad, o (iii) tanto visualmente como a través de una prueba de normalidad. Sin embargo, tenga en cuenta los dos puntos siguientes:\n\nANVA es bastante robusto a pequeñas desviaciones de la normalidad. Esto significa que no es un problema (desde la perspectiva de la interpretación de los resultados de ANVA) si un pequeño número de puntos se desvía ligeramente de la normalidad,\nLas pruebas de normalidad son a veces bastante conservadoras, lo que significa que la hipótesis nula de normalidad puede rechazarse debido a una desviación limitada de la normalidad. Este es especialmente el caso con muestras grandes, ya que la potencia de la prueba aumenta con el tamaño de la muestra.\n\nEn la práctica, se tiende a preferir el (i) enfoque visual solamente, pero nuevamente, esto es una cuestión de elección personal y también depende del contexto del análisis. Tambien, puede utilizar la prueba de Shapiro-Wilk o la prueba de Kolmogorov-Smirnov, entre otras.\n4. Igualdad de varianzas - homogeneidad\nSuponiendo que los residuos siguen una distribución normal, ahora es el momento de comprobar si las varianzas son iguales entre especies o no. El resultado tendrá un impacto en si usamos el ANVA o la prueba de Welch.\nEsto se puede verificar nuevamente visualmente, a través de una gráfica de caja o gráfica de puntos, o más formalmente a través de una prueba estadística (la prueba de Levene, entre otras).\nVisualmente tenemos:\n\n\n# Boxplot\nboxplot(Sepal.Width ~ Species,\n  data = iris\n)\n\n\n\n\n\n\n# Dotplot\n\ndotplot(Sepal.Width ~ Species,\n  data = iris\n)\n\n\n\n\nTanto la gráfica de boxplot como la gráfica de puntos muestran una variación similar para las diferentes especies. En el boxplot, esto se puede ver por el hecho de que las cajas y los bigotes tienen un tamaño comparable para todas las especies. Hay un par de valores atípicos como lo muestran los puntos fuera de los bigotes, pero esto no cambia el hecho de que la dispersión es más o menos la misma entre las diferentes especies.\nEn la gráfica de puntos, esto se puede ver por el hecho de que los puntos para las 3 especies tienen más o menos el mismo rango, un signo de la dispersión y, por lo tanto, la varianza es similar.\nAl igual que el supuesto de normalidad, si cree que el enfoque visual no es suficiente, puede probar formalmente la igualdad de las varianzas con una prueba de Levene o de Bartlett. Observe que la prueba de Levene es menos sensible a las desviaciones de la distribución normal que la prueba de Bartlett.\nLas hipótesis nula y alternativa para ambas pruebas son:\nH0: las variaciones son iguales\nH1: al menos una varianza es diferente\nEn R, la prueba de Levene se puede realizar gracias a la función leveneTest() del paquete {car}:\n\n\n# Levene's test\n\nleveneTest(Sepal.Width ~ Species,\n  data = iris\n)\n\n\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup   2  0.5902 0.5555\n      147               \n\nSiendo el p-valor mayor que el nivel de significancia de 0.05, no rechazamos la hipótesis nula, por lo que no podemos rechazar la hipótesis de que las varianzas son iguales entre especies (p-valor = 0.556).\nEste resultado también está en línea con el enfoque visual, por lo que la homogeneidad de las variaciones se cumple tanto visual como formalmente.\nAnálisis de varianza en R\nEl ANVA puede ayudarnos a hacer inferencias sobre la población dada la muestra en cuestión y ayudarnos a responder la pregunta de investigación “¿Existe diferencia en ancho de sépalo para las 3 especies?”.\nEl ANVA en R se puede realizar de varias formas, de las cuales tres se presentan a continuación:\na). Con la función oneway.test():\n\n\n# primer metodo:\noneway.test(Sepal.Width ~ Species,\n  data = iris,\n  var.equal = TRUE # asumiendo varianzas iguales\n)\n\n\n\n    One-way analysis of means\n\ndata:  Sepal.Width and Species\nF = 49.16, num df = 2, denom df = 147, p-value < 2.2e-16\n\nb). Con las funciones de summary() y aov():\n\n\n# 2nd method:\nres_aov <- aov(Sepal.Width ~ Species,\n  data = iris\n)\n\nsummary(res_aov)\n\n\n             Df Sum Sq Mean Sq F value Pr(>F)    \nSpecies       2  11.35   5.672   49.16 <2e-16 ***\nResiduals   147  16.96   0.115                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nComo puede ver en los dos resultados anteriores, la estadística de prueba (F = en el primer método y el valor F en el segundo) y el p-valor (p-valor en el primer método y Pr (> F) en el segundo) son exactamente iguales para ambos métodos, lo que significa que en caso de variaciones iguales, los resultados y las conclusiones no cambiarán.\nLa ventaja del primer método es que es fácil cambiar del ANVA (utilizado cuando las variaciones son iguales) a la prueba de Welch (utilizado cuando las variaciones son desiguales). Esto se puede hacer reemplazando nvar.equal = TRUE por var.equal = FALSE, como se presenta a continuación:\n\n\noneway.test(Sepal.Width ~ Species,\n  data = iris,\n  var.equal = FALSE # asumiendo variaciones desiguales\n)\n\n\n\n    One-way analysis of means (not assuming equal variances)\n\ndata:  Sepal.Width and Species\nF = 45.012, num df = 2.000, denom df = 97.402, p-value =\n1.433e-14\n\nSin embargo, la ventaja del segundo método es que:\nSe imprime la tabla ANVA completa (con grados de libertad, cuadrados medios, etc.), lo que puede ser de interés en algunos casos (teóricos).\nlos resultados del ANVA (res_aov) se pueden guardar para su uso posterior (especialmente útil para pruebas de promedio)\nInterpretaciones de los resultados del ANVA\nDado que el p-valor es menor que 0.05, rechazamos la hipótesis nula, por lo que rechazamos la hipótesis de que todas las medias son iguales. Por tanto, podemos concluir que al menos una especie es diferente a las otras en términos del ancho de sépalo (p-valor <2.2e-16).\n¿Que sigue?\nSi no se rechaza la hipótesis nula (p-valor ≥ 0,05), significa que no rechazamos la hipótesis de que todos los grupos son iguales. El ANVA más o menos se detiene aquí. Por supuesto, se pueden realizar otros tipos de análisis, pero, dados los datos disponibles, no pudimos probar que al menos un grupo fuera diferente, por lo que generalmente no avanzamos más con el ANVA.\nPor el contrario, si y solo si se rechaza la hipótesis nula (como es nuestro caso ya que el p-valor < 0.05), probamos que al menos un grupo es diferente. Podemos decidir detenernos aquí si solo estamos interesados en probar si todas las especies son iguales en términos de ancho de sépalo.\nPero la mayoría de las veces, cuando demostramos gracias a un ANVA que al menos un grupo es diferente, también nos interesa saber cuál es diferente. Para probar esto, necesitamos usar otros tipos de prueba, denominados pruebas de promedio o pruebas de comparación múltiple por pares. Esta familia de pruebas estadísticas es el tema de las siguientes secciones.\nPruebas de promedio en R y su interpretación\nLas pruebas de promedio son una familia de pruebas estadísticas, por lo que hay varias. Las más utilizadas son las pruebas Tukey HSD y Dunnett:\nTukey HSD se utiliza para comparar todos los grupos entre sí (por lo que todas las posibles comparaciones de 2 grupos).\nDunnett se utiliza para hacer comparaciones con un grupo de referencia. Por ejemplo, considere 2 grupos de tratamiento y un grupo de control. Si solo desea comparar los 2 grupos de tratamiento con respecto al grupo de control y no desea comparar los 2 grupos de tratamiento entre sí, se prefiere la prueba de Dunnett.\nAmbas pruebas se presentan en las siguientes secciones.\nPrueba de Tukey HSD\nEn nuestro caso, dado que no existe una especie de “referencia” y nos interesa comparar todas las especies, vamos a utilizar la prueba de Tukey HSD.\nEn R, la prueba de Tukey HSD se realiza de la siguiente manera. Aquí es donde el segundo método para realizar el ANVA resulta útil porque los resultados (res_aov) se reutilizan para la prueba de promedios:\n\n\n# Prueba de Tukey HSD:\npost_test <- glht(res_aov,\n  linfct = mcp(Species = \"Tukey\")\n)\nsummary(post_test)\n\n\n\n     Simultaneous Tests for General Linear Hypotheses\n\nMultiple Comparisons of Means: Tukey Contrasts\n\n\nFit: aov(formula = Sepal.Width ~ Species, data = iris)\n\nLinear Hypotheses:\n                            Estimate Std. Error t value Pr(>|t|)    \nversicolor - setosa == 0    -0.65800    0.06794  -9.685  < 1e-04 ***\nvirginica - setosa == 0     -0.45400    0.06794  -6.683  < 1e-04 ***\nvirginica - versicolor == 0  0.20400    0.06794   3.003  0.00874 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n(Adjusted p values reported -- single-step method)\n\nEn el resultado de la prueba Tukey HSD, nos interesa la tabla que se muestra después de las Hipótesis lineales: más precisamente, en la primera y última columna de la tabla. La primera columna muestra las comparaciones que se han realizado; la última columna (Pr(>|t|)) muestra los p-valores ajustados para cada comparación (con la hipótesis nula siendo los dos grupos iguales y la hipótesis alternativa siendo los dos grupos diferentes).\nSon estos p-valores ajustados los que se utilizan para probar si dos grupos son significativamente diferentes o no. En nuestro ejemplo, probamos:\nversicolor vs setosa (línea versicolor - setosa == 0)\nvirginica vs setosa (línea virginica - setosa == 0)\nvirginica vs versicolor (línea virginica - versicolor == 0)\nLos tres p-valores son menores que 0.05, por lo que rechazamos la hipótesis nula para todas las comparaciones, lo que significa que todas las especies son significativamente diferentes en términos de ancho de sépalo.\nTenga en cuenta que la prueba Tukey HSD también se puede realizar en R con la función TukeyHSD():\n\n\nTukeyHSD(res_aov)\n\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Sepal.Width ~ Species, data = iris)\n\n$Species\n                       diff         lwr        upr     p adj\nversicolor-setosa    -0.658 -0.81885528 -0.4971447 0.0000000\nvirginica-setosa     -0.454 -0.61485528 -0.2931447 0.0000000\nvirginica-versicolor  0.204  0.04314472  0.3648553 0.0087802\n\nCon este código, es la columna p adj (también la última columna) la que interesa. Tenga en cuenta que las conclusiones son las mismas que las anteriores: todas las especies son significativamente diferentes en términos de ancho de sépalo.\nVisualización de ANVA y pruebas de promedio\nPara realizar de forma más fácil un análisis de varianza, se puede usar la librería easyanova para analizar diferentes diseños experimentales.\nAnálisis de varianza con easyanova\nPara proceder con ANVA los datos de iris se selecciona y ordena para dar uso con el paquete easyanova.\n\n\nfsdata <- iris %>%\n  dplyr::select(Species, Sepal.Width)\ntibble(fsdata)\n\n\n# A tibble: 150 x 2\n   Species Sepal.Width\n   <fct>         <dbl>\n 1 setosa          3.5\n 2 setosa          3  \n 3 setosa          3.2\n 4 setosa          3.1\n 5 setosa          3.6\n 6 setosa          3.9\n 7 setosa          3.4\n 8 setosa          3.4\n 9 setosa          2.9\n10 setosa          3.1\n# … with 140 more rows\n\n\n\n# Análisis de varianza para DCA\n\nr1 <- ea1(data = fsdata, # Base de datos\n          design = 1, # Diseño experimental: 1=DCA, 2=DBCA, etc.\n          alpha = 0.05) # Probabilidad estadística\n\n\n\nr1\n\n\n$`Analysis of variance`\n            df type I SS mean square F value    p>F\ntreatments   2   11.3449      5.6725   49.16 <0.001\nResiduals  147   16.9620      0.1154       -      -\n\n$Means\n   treatment  mean standard.error tukey snk duncan t scott_knott\n1     setosa 3.428          0.048     a   a      a a           a\n2  virginica 2.974          0.048     b   b      b b           b\n3 versicolor 2.770          0.048     c   c      c c           c\n\n$`Multiple comparison test`\n                    pair contrast p(tukey) p(snk) p(duncan)   p(t)\n1     setosa - virginica    0.454   0.0000 0.0000    0.0000 0.0000\n2    setosa - versicolor    0.658   0.0000 0.0000    0.0000 0.0000\n3 virginica - versicolor    0.204   0.0087 0.0031    0.0031 0.0031\n\n$`Residual analysis`\n$`Residual analysis`$`residual analysis`\n                               values\np.value Shapiro-Wilk test      0.3230\np.value Bartlett test          0.3515\ncoefficient of variation (%)  11.1100\nfirst value most discrepant   42.0000\nsecond value most discrepant  16.0000\nthird value most discrepant  118.0000\n\n$`Residual analysis`$residuals\n     1      2      3      4      5      6      7      8      9     10 \n 0.072 -0.428 -0.228 -0.328  0.172  0.472 -0.028 -0.028 -0.528 -0.328 \n    11     12     13     14     15     16     17     18     19     20 \n 0.272 -0.028 -0.428 -0.428  0.572  0.972  0.472  0.072  0.372  0.372 \n    21     22     23     24     25     26     27     28     29     30 \n-0.028  0.272  0.172 -0.128 -0.028 -0.428 -0.028  0.072 -0.028 -0.228 \n    31     32     33     34     35     36     37     38     39     40 \n-0.328 -0.028  0.672  0.772 -0.328 -0.228  0.072  0.172 -0.428 -0.028 \n    41     42     43     44     45     46     47     48     49     50 \n 0.072 -1.128 -0.228  0.072  0.372 -0.428  0.372 -0.228  0.272 -0.128 \n    51     52     53     54     55     56     57     58     59     60 \n 0.430  0.430  0.330 -0.470  0.030  0.030  0.530 -0.370  0.130 -0.070 \n    61     62     63     64     65     66     67     68     69     70 \n-0.770  0.230 -0.570  0.130  0.130  0.330  0.230 -0.070 -0.570 -0.270 \n    71     72     73     74     75     76     77     78     79     80 \n 0.430  0.030 -0.270  0.030  0.130  0.230  0.030  0.230  0.130 -0.170 \n    81     82     83     84     85     86     87     88     89     90 \n-0.370 -0.370 -0.070 -0.070  0.230  0.630  0.330 -0.470  0.230 -0.270 \n    91     92     93     94     95     96     97     98     99    100 \n-0.170  0.230 -0.170 -0.470 -0.070  0.230  0.130  0.130 -0.270  0.030 \n   101    102    103    104    105    106    107    108    109    110 \n 0.326 -0.274  0.026 -0.074  0.026  0.026 -0.474 -0.074 -0.474  0.626 \n   111    112    113    114    115    116    117    118    119    120 \n 0.226 -0.274  0.026 -0.474 -0.174  0.226  0.026  0.826 -0.374 -0.774 \n   121    122    123    124    125    126    127    128    129    130 \n 0.226 -0.174 -0.174 -0.274  0.326  0.226 -0.174  0.026 -0.174  0.026 \n   131    132    133    134    135    136    137    138    139    140 \n-0.174  0.826 -0.174 -0.174 -0.374  0.026  0.426  0.126  0.026  0.126 \n   141    142    143    144    145    146    147    148    149    150 \n 0.126  0.126 -0.274  0.226  0.326  0.026 -0.474  0.026  0.426  0.026 \n\n$`Residual analysis`$`standardized residuals`\n          1           2           3           4           5 \n 0.21339641 -1.26852308 -0.67575529 -0.97213918  0.50978030 \n          6           7           8           9          10 \n 1.39893200 -0.08298749 -0.08298749 -1.56490698 -0.97213918 \n         11          12          13          14          15 \n 0.80616420 -0.08298749 -1.26852308 -1.26852308  1.69531589 \n         16          17          18          19          20 \n 2.88085148  1.39893200  0.21339641  1.10254810  1.10254810 \n         21          22          23          24          25 \n-0.08298749  0.80616420  0.50978030 -0.37937139 -0.08298749 \n         26          27          28          29          30 \n-1.26852308 -0.08298749  0.21339641 -0.08298749 -0.67575529 \n         31          32          33          34          35 \n-0.97213918 -0.08298749  1.99169979  2.28808369 -0.97213918 \n         36          37          38          39          40 \n-0.67575529  0.21339641  0.50978030 -1.26852308 -0.08298749 \n         41          42          43          44          45 \n 0.21339641 -3.34321036 -0.67575529  0.21339641  1.10254810 \n         46          47          48          49          50 \n-1.26852308  1.10254810 -0.67575529  0.80616420 -0.37937139 \n         51          52          53          54          55 \n 1.27445076  1.27445076  0.97806686 -1.39300432  0.08891517 \n         56          57          58          59          60 \n 0.08891517  1.57083466 -1.09662042  0.38529907 -0.20746873 \n         61          62          63          64          65 \n-2.28215601  0.68168296 -1.68938822  0.38529907  0.38529907 \n         66          67          68          69          70 \n 0.97806686  0.68168296 -0.20746873 -1.68938822 -0.80023652 \n         71          72          73          74          75 \n 1.27445076  0.08891517 -0.80023652  0.08891517  0.38529907 \n         76          77          78          79          80 \n 0.68168296  0.08891517  0.68168296  0.38529907 -0.50385263 \n         81          82          83          84          85 \n-1.09662042 -1.09662042 -0.20746873 -0.20746873  0.68168296 \n         86          87          88          89          90 \n 1.86721855  0.97806686 -1.39300432  0.68168296 -0.80023652 \n         91          92          93          94          95 \n-0.50385263  0.68168296 -0.50385263 -1.39300432 -0.20746873 \n         96          97          98          99         100 \n 0.68168296  0.38529907  0.38529907 -0.80023652  0.08891517 \n        101         102         103         104         105 \n 0.96621151 -0.81209188  0.07705981 -0.21932408  0.07705981 \n        106         107         108         109         110 \n 0.07705981 -1.40485967 -0.21932408 -1.40485967  1.85536320 \n        111         112         113         114         115 \n 0.66982761 -0.81209188  0.07705981 -1.40485967 -0.51570798 \n        116         117         118         119         120 \n 0.66982761  0.07705981  2.44813099 -1.10847578 -2.29401137 \n        121         122         123         124         125 \n 0.66982761 -0.51570798 -0.51570798 -0.81209188  0.96621151 \n        126         127         128         129         130 \n 0.66982761 -0.51570798  0.07705981 -0.51570798  0.07705981 \n        131         132         133         134         135 \n-0.51570798  2.44813099 -0.51570798 -0.51570798 -1.10847578 \n        136         137         138         139         140 \n 0.07705981  1.26259540  0.37344371  0.07705981  0.37344371 \n        141         142         143         144         145 \n 0.37344371  0.37344371 -0.81209188  0.66982761  0.96621151 \n        146         147         148         149         150 \n 0.07705981 -1.40485967  0.07705981  1.26259540  0.07705981 \n\nEn la salida se puede observar el resultado de análisis de varianza, prueba de promedios y comparación múltiple de medias. Estas salidas son muy fáciles de obtener y poder interpretar las mismas. Asimismo, se puede verificar la normalidad y coeficiente de variación de los datos.\nVisualización de la prueba de promedios\nSi está interesado en incluir resultados de ANVA y pruebas de promedio directamente en los boxplot, aquí hay un fragmento de código que puede ser de su interés:\n\n\n#paquete para p-valor en la visualización de prueba de promedios\n\ndat <- iris\n# Editar desde aquí\nx <- which(names(dat) == \"Species\") #variable de agrupación\ny <- which(names(dat) == \"Sepal.Width\") \n#variables para la prueba de promedios\n          #| names(dat) == \"Sepal.Length\"\n          #| names(dat) == \"Petal.Length\"\n          #| names(dat) == \"Petal.Width\")\nmethod1 <- \"anova\" # Una de \"anova\" o \"kruskal.test\"\nmethod2 <- \"t.test\" # Una de \"wilcox.test\" o \"t.test\"\nmy_comparisons <- list(c(\"setosa\", \"versicolor\"), \n                       c(\"setosa\", \"virginica\"), \n                       c(\"versicolor\", \"virginica\")) \n# comparaciones para pruebas de promedio\n# Editar hasta aquí\n\n# Edit at your own risk\nfor (i in y) {\n  for (j in x) {\n    p <- ggboxplot(dat,\n      x = colnames(dat[j]), y = colnames(dat[i]),\n      color = colnames(dat[j]),\n      legend = \"none\",\n      palette = \"npg\",\n      add = \"jitter\"\n    )\n    print(\n      p + stat_compare_means(aes(\n        label = paste0(..method.., \", p-value = \", ..p.format..)),\n        method = method1, label.y = max(dat[, i], na.rm = TRUE)\n      )\n      + stat_compare_means(comparisons = my_comparisons, \n                           method = method2, label = \"p.format\") \n      # remove if p-value of ANOVA or Kruskal-Wallis test >= alpha\n    )\n  }\n}\n\n\n\n\nOtra opción de gráfica para observar la significancia entre las medias de cada par de especies.\n\n\n# pairwise comparisons\n\npwc <- fsdata %>%\n  pairwise_t_test(\n    Sepal.Width ~ Species, pool.sd = FALSE,\n    p.adjust.method = \"none\"\n    )\n\n# Visualization: box plots with p-values\npwc <- pwc %>% add_xy_position(x = \"Species\")\nggboxplot(fsdata, x = \"Species\", y = \"Sepal.Width\",\n          color = \"Species\", \n          legend = \"none\", \n          add = \"jitter\") +\n  stat_pvalue_manual(pwc, hide.ns = TRUE) \n\n\n\n\nConclusión\nLa figura de prueba de promedios es muy buena opción para incluir en la sección de resultados de los reportes de investigación. La figura incluye el resultado de p-valor del análisis de varianza, además, p-valor para la comparación de medias entre especies o tratamientos de la investigación.\nReferencias\nR bloggers 2020. ANOVA in R\nSoetewey A. 2020. How to do a t-test or ANOVA for more than one variable at once in R\n\n\n\n",
    "preview": "posts/2021-03-14-anova/featured.png",
    "last_modified": "2021-03-14T17:42:57-04:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-14-analiscorrespondencia/",
    "title": "Análisis de correspondencia con R",
    "description": "Análisis para variables categóricas utilizando la metodología de tablas cruzadas con la prueba de chi-cuadrado. Este análisis es una recopilación del libro Multivariate Analysis II: Practical Guide To Principal Component Methods in R.",
    "author": [
      {
        "name": "Franklin Santos",
        "url": "https://franklinsantos.com"
      }
    ],
    "date": "2020-11-07",
    "categories": [
      "Chi-cuadrado",
      "Biplot",
      "Componentes Principales"
    ],
    "contents": "\nIntroducción\nEl análisis de correspondencia (CA) es una extensión del análisis de componentes principales (Capítulo 4) adecuado para explorar relaciones entre variables cualitativas (o datos categóricos). Al igual que el análisis de componentes principales, proporciona una solución para resumir y visualizar conjuntos de datos en gráficos de dos dimensiones.\nAquí, describimos el análisis de correspondencia simple, que se utiliza para analizar frecuencias formadas por dos datos categóricos, una tabla de datos conocida como tabla de contingencia, tambien se conoce como tablas cruzadas. Proporciona puntuaciones de factores (coordenadas) para los puntos de fila y columna de la tabla de contingencia. Estas coordenadas se utilizan para visualizar gráficamente la asociación entre elementos de fila y columna en la tabla de contingencia.\nAl analizar una tabla de contingencia bidireccional, una pregunta típica es si ciertos elementos de fila están asociados con algunos elementos de elementos de columna. El análisis de correspondencia es un enfoque geométrico para visualizar las filas y columnas de una tabla de contingencia bidireccional como puntos en un espacio de baja dimensión, de modo que las posiciones de los puntos de fila y columna sean consistentes con sus asociaciones en la tabla. El objetivo es tener una visión global de los datos que sea útil para la interpretación.\nEn el capítulo actual, mostraremos cómo calcular e interpretar el análisis de correspondencia usando dos paquetes R: i) FactoMineR para el análisis y ii) factoextra para la visualización de datos. Además, mostraremos cómo revelar las variables más importantes que explican las variaciones en un conjunto de datos.\nProcedimiento computacional en R\nCargar paquetes\n\n\nlibrary(FactoMineR)\nlibrary(factoextra)\n\n\n\nFormato de datos\nLos datos deben ser una tabla de contingencia (resultados de tablas cruzadas). Usaremos los conjuntos de datos de demostración de tareas domésticas disponibles en el paquete factoextra R.\n\n\ndata(housetasks)\n\n\n\nLos datos son una tabla de contingencia que contiene 13 tareas del hogar y su reparto en la pareja:\nlas filas son las diferentes tareas\nLos valores son las frecuencias de las tareas realizadas:\nsolo por la esposa “wife only”\nalternativamente “Alternating”\nsolo por el marido “husband only”\no conjuntamente \"jointly\n\nLos datos se ilustran en la siguiente salida:\n\n           Wife Alternating Husband Jointly\nLaundry     156          14       2       4\nMain_meal   124          20       5       4\nDinner       77          11       7      13\nBreakfeast   82          36      15       7\nTidying      53          11       1      57\nDishes       32          24       4      53\nShopping     33          23       9      55\nOfficial     12          46      23      15\nDriving      10          51      75       3\nFinances     13          13      21      66\nInsurance     8           1      53      77\nRepairs       0           3     160       2\nHolidays      0           1       6     153\n\nGráfica de tablas de contingencia y prueba de chi-cuadrado\nLa tabla de contingencia anterior no es muy grande. Por lo tanto, es fácil inspeccionar e interpretar visualmente los perfiles de filas y columnas:\nEs evidente que las tareas de la casa (lavandería, comida principal y cena) las realiza con más frecuencia la “esposa”.\nLas reparaciones y la conducción las realiza predominantemente el marido.\nLos días festivos se asocian con frecuencia con la columna “conjuntamente”\nEl análisis de datos exploratorios y la visualización de tablas de contingencia se cubrieron en nuestro artículo anterior: Prueba de independencia de chi-cuadrado en R. Brevemente, la tabla de contingencia se puede visualizar utilizando las funciones balloonplot() [paquete gplots] y mosaicplot() [paquete graphics]:\n\n\nlibrary(gplots)\n#1. Convierte el dato como una tabla\ndt <- as.table(as.matrix(housetasks))\n# 2. Graph\nballoonplot(t(dt), main =\"housetasks\", xlab =\"\", ylab=\"\",\n            label = FALSE, show.margins = FALSE)\n\n\n\n\n\nTenga en cuenta que las sumas de filas y columnas se imprimen de forma predeterminada en los márgenes inferior y derecho, respectivamente. Estos valores están ocultos, en el gráfico anterior, utilizando el argumento show.margins = FALSE.\n\nPara una tabla de contingencia pequeña, puede utilizar la prueba de chi-cuadrado para evaluar si existe una dependencia significativa entre las categorías de filas y columnas:\n\n\nchisq <- chisq.test(housetasks)\nchisq\n\n\n\n    Pearson's Chi-squared test\n\ndata:  housetasks\nX-squared = 1944.5, df = 36, p-value < 2.2e-16\n\n\nEn nuestro ejemplo, las variables de fila y columna están asociadas de manera estadísticamente significativa (*valor p* = r chisq$p.value).\n\nCódigo R para calcular CA (Analisis de Correspondencia)\nSe puede utilizar la función CA() [paquete FactoMiner]. Un formato simplificado es:\n\nCA(X, ncp = 5, graph = TRUE)\n\n\nX: es un marco de datos (tabla de contingencia)\nncp: número de dimensiones mantenidas en los resultados finales.\ngraph: un valor lógico. Si es TRUE, se muestra un gráfico.\n\nPara calcular el análisis de correspondencia, escriba esto:\n\n\nlibrary(\"FactoMineR\")\n#housetasks es nuestro marco de datos\nres.ca <- CA(housetasks, graph = FALSE)\n\n\n\nLa salida de la función CA() es una lista que incluye:\n\n\nprint(res.ca)\n\n\n**Results of the Correspondence Analysis (CA)**\nThe row variable has  13  categories; the column variable has 4 categories\nThe chi square of independence between the two variables is equal to 1944.456 (p-value =  0 ).\n*The results are available in the following objects:\n\n   name              description                   \n1  \"$eig\"            \"eigenvalues\"                 \n2  \"$col\"            \"results for the columns\"     \n3  \"$col$coord\"      \"coord. for the columns\"      \n4  \"$col$cos2\"       \"cos2 for the columns\"        \n5  \"$col$contrib\"    \"contributions of the columns\"\n6  \"$row\"            \"results for the rows\"        \n7  \"$row$coord\"      \"coord. for the rows\"         \n8  \"$row$cos2\"       \"cos2 for the rows\"           \n9  \"$row$contrib\"    \"contributions of the rows\"   \n10 \"$call\"           \"summary called parameters\"   \n11 \"$call$marge.col\" \"weights of the columns\"      \n12 \"$call$marge.row\" \"weights of the rows\"         \n\n\nEl objeto que se crea usando la función CA() contiene mucha información que se encuentra en muchas listas y matrices diferentes. Estos valores se describen en la siguiente sección.\n\nVisualización e interpretación\nUsaremos las siguientes funciones [in factoextra] para ayudar en la interpretación y visualización del análisis de correspondencia:\nget_eigenvalue(res.ca): Extraiga los autovalores/varianzas retenidos por cada dimensión (eje)\nfviz_eig(res.ca): Visualiza los valores propios\nget_ca_row(res.ca), get_ca_col(res.ca): Extrae los resultados para filas y columnas, respectivamente.\nfviz_ca_row(res.ca), fviz_ca_col(res.ca): Visualiza los resultados para filas y columnas, respectivamente.\nfviz_ca_biplot(res.ca): Crea un biplot de filas y columnas.\nEn las siguientes secciones, ilustraremos cada una de estas funciones.\nSignificación estadística\nPara interpretar el análisis de correspondencia, el primer paso es evaluar si existe una dependencia significativa entre las filas y las columnas.\nUn método riguroso consiste en utilizar la estadística de chi-cuadrado para examinar la asociación entre las variables de fila y columna. Esto aparece en la parte superior y es generado por la función summary(res.ca) o print(res.ca), ver sección “Gráfica de tablas de contingencia y prueba de chi-cuadrado”. Una estadística de chi-cuadrado alta significa un vínculo fuerte entre las variables de fila y columna o sea, la probabilidad de chi cuadrado deberá ser inferior a 0.05.\n\nEn nuestro ejemplo, la asociación es muy significativa (chi-cuadrado: 1944,456, p = 0).\n\n\n\n# Chi-square statistics\nchi2 <- 1944.456\nchi2\n\n\n[1] 1944.456\n\n# Degree of freedom\ndf <- (nrow(housetasks) - 1) * (ncol(housetasks) - 1)\ndf\n\n\n[1] 36\n\n# P-value\npval <- pchisq(chi2, df = df, lower.tail = FALSE)\npval\n\n\n[1] 0\n\nValores propios/Varianzas\nRecuerde que examinamos los valores propios para determinar el número de ejes a considerar. Los valores propios y la proporción de varianzas retenidas por los diferentes ejes se pueden extraer utilizando la función get_eigenvalue() [paquete factoextra]. Los valores propios son grandes para el primer eje y pequeños para el eje siguiente.\n\n\nlibrary(\"factoextra\")\neig.val <- get_eigenvalue(res.ca)\neig.val\n\n\n      eigenvalue variance.percent cumulative.variance.percent\nDim.1  0.5428893         48.69222                    48.69222\nDim.2  0.4450028         39.91269                    88.60491\nDim.3  0.1270484         11.39509                   100.00000\n\nLos valores propios corresponden a la cantidad de información retenida por cada eje. Las dimensiones se ordenan de forma decreciente y se enumeran de acuerdo con la cantidad de variación explicada en la solución. La dimensión 1 explica la mayor variación en la solución, seguida de la dimensión 2 y así sucesivamente.\nEl porcentaje acumulado explicado se obtiene sumando las sucesivas proporciones de variación explicadas para obtener el total acumulado. Por ejemplo, 48,69% más 39,91% es igual a 88,6% y así sucesivamente. Por lo tanto, aproximadamente el 88,6% de la variación se explica por las dos primeras dimensiones.\nLos valores propios se pueden utilizar para determinar el número de ejes que se deben retener. No existe una “regla general” para elegir el número de dimensiones que se deben mantener para la interpretación de los datos. Depende de la pregunta de investigación y la necesidad del investigador. Por ejemplo, si está satisfecho con el 80% de las variaciones totales explicadas, utilice la cantidad de dimensiones necesarias para lograrlo.\n\nTenga en cuenta que se logra una buena reducción de dimensión cuando las primeras dimensiones representan una gran proporción de la variabilidad.\n\nEn nuestro análisis, los dos primeros ejes explican el 88,6% de la variación. Este es un porcentaje aceptablemente grande.\nUn método alternativo para determinar el número de dimensiones es mirar una gráfica de Scree Plot, que es el diagrama de valores propios/varianzas ordenados de mayor a menor. El número de componentes se determina en el punto, más allá del cual los valores propios restantes son todos relativamente pequeños y de tamaño comparable.\nEl gráfico Scree plot se puede realizar usando la función fviz_eig() o fviz_screeplot() [paquete factoextra].\n\n\nfviz_screeplot(res.ca, addlabels = TRUE, ylim = c(0, 50))\n\n\n\n\n\nSe puede considerar que el punto en el que el gráfico de pedregal muestra una curvatura (denominado “codo”) indica una dimensionalidad óptima.\n\nTambién es posible calcular un valor propio promedio por encima del cual el eje debe mantenerse en la solución.\n\nNuestros datos contienen 13 filas y 4 columnas.\nSi los datos fueran aleatorios, el valor esperado del valor propio para cada eje sería 1/(nrow(housetasks)-1) = 1/12 = 8,33% en términos de filas.\nAsimismo, el eje promedio debe representar 1/(ncol(housetasks)-1) = 1/3 = 33,33% en términos de las 4 columnas.\n\nSegún (M. T. Bendixen 1995): >Cualquier eje con una contribución mayor que el máximo de estos dos porcentajes debe ser considerado como importante e incluido en la solución para la interpretación de los datos.\nEl código R a continuación, dibuja el gráfico de pantalla con una línea discontinua roja que especifica el valor propio promedio:\n\n\nfviz_screeplot(res.ca) +\n  geom_hline(yintercept=33.33, linetype=2, color=\"red\")\n\n\n\n\nSegún el gráfico anterior, solo las dimensiones 1 y 2 deben usarse en la solución. La dimensión 3 explica sólo el 11,4% de la inercia total, que está por debajo del valor propio medio (33,33%) y es demasiado poco para guardarlo para un análisis más detallado.\n\nTenga en cuenta que puede utilizar más de 2 dimensiones. Sin embargo, es poco probable que las dimensiones complementarias contribuyan de manera significativa a la interpretación de la naturaleza de la asociación entre filas y columnas.\n\nLas dimensiones 1 y 2 explican aproximadamente el 48,7% y el 39,9% de la inercia total, respectivamente. Esto corresponde a un total acumulado del 88,6% de la inercia total retenida por las 2 dimensiones. Cuanto mayor sea la retención, más sutileza en los datos originales se retiene en la solución de baja dimensión (M. Bendixen 2003).\nBiplot\nLa función fviz_ca_biplot() [paquete factoextra] se puede utilizar para dibujar el biplot de las variables de filas y columnas.\n\n\n# repel= TRUE para evitar la superposición de texto (lenta si tiene muchos puntos)\nfviz_ca_biplot(res.ca, repel = TRUE)\n\n\n\n\nEl gráfico anterior se llama gráfico simétrico y muestra un patrón global dentro de los datos. Las filas están representadas por puntos azules y las columnas por triángulos rojos.\nLa distancia entre cualquier punto de fila o columna da una medida de su similitud (o disimilitud). Los puntos de fila con un perfil similar se cierran en el mapa de factores. Lo mismo es válido para los puntos de columna.\n\nEste gráfico muestra que:\nLas tareas de la casa, como la cena, el desayuno y la ropa, las hace la esposa con más frecuencia.\nLa conducción y las reparaciones las realiza el marido.\n\n\nEl gráfico simétrico representa los perfiles de fila y columna simultáneamente en un espacio común. En este caso, solo se puede interpretar realmente la distancia entre puntos de fila o la distancia entre puntos de columna.\n¡La distancia entre cualquier elemento de fila y columna no es significativa! Solo puede hacer declaraciones generales sobre el patrón observado.\nPara interpretar la distancia entre los puntos de columna y fila, los perfiles de columna deben presentarse en el espacio de fila o viceversa. Este tipo de mapa se llama biplot asimétrico y se analiza al final de este artículo.\n\nEl siguiente paso para la interpretación es determinar qué variables de fila y columna contribuyen más en la definición de las diferentes dimensiones retenidas en el modelo.\nOpciones de biplot\nBiplot es una visualización gráfica de filas y columnas en 2 o 3 dimensiones. Ya hemos descrito cómo crear CA biplots en la sección anterior. Aquí, describiremos diferentes tipos de biplots de CA.\nBiplot simétrico\nComo se mencionó anteriormente, el gráfico estándar del análisis de correspondencia es un biplot simétrico en el que tanto las filas (puntos azules) como las columnas (triángulos rojos) se representan en el mismo espacio utilizando las coordenadas principales. Estas coordenadas representan los perfiles de fila y columna. En este caso, solo se puede interpretar realmente la distancia entre puntos de fila o la distancia entre puntos de columna.\n\nCon la gráfica simétrica, la distancia entre filas y columnas no se puede interpretar. Solo se pueden hacer declaraciones generales sobre el patrón.\n\n\n\nfviz_ca_biplot(res.ca, repel = TRUE)\n\n\n\n\n\nTenga en cuenta que, para interpretar la distancia entre los puntos de la columna y los puntos de la fila, la forma más sencilla es hacer una gráfica asimétrica. Esto significa que los perfiles de columna deben presentarse en el espacio de la fila o viceversa.\n\nBiplot asimétrico\nPara hacer un biplot asimétrico, los puntos de las filas (o columnas) se trazan a partir de las coordenadas estándar (S) y los perfiles de las columnas (o las filas) se trazan a partir de las coordenadas principales (P) (M. Bendixen 2003).\nPara un eje dado, las coordenadas estándar y principal se relacionan de la siguiente manera:\nP = sqrt(valor propio) X S\nP: la coordenada principal de una fila (o una columna) en el eje\nvalor propio: el valor propio del eje\nDependiendo de la situación, se pueden configurar otros tipos de visualización utilizando el mapa de argumentos (Nenadic y Greenacre 2007) en la función fviz_ca_biplot() [in factoextra].\nLas opciones permitidas para el mapa de argumentos son:\n“rowprincipal” o “colprincipal”: estos son los llamados biplots asimétricos, con filas en coordenadas principales y columnas en coordenadas estándar, o viceversa (también conocido como preservar métricas de filas o preservar métricas de columnas, respectivamente).\n“rowprincipal”: las columnas se representan en el espacio de las filas\n“colprincipal”: las filas se representan en el espacio de la columna\n\n“symbiplot”: tanto las filas como las columnas se escalan para tener varianzas iguales a los valores singulares (raíces cuadradas de los valores propios), lo que da un biplot simétrico pero no conserva las métricas de filas o columnas.\n“rowgab” o “colgab”: mapas asimétricos propuestos por Gabriel y Odoroff (Gabriel y Odoroff 1990):\n“rowgab”: filas en coordenadas principales y columnas en coordenadas estándar multiplicadas por la masa.\n“colgab”: columnas en coordenadas principales y filas en coordenadas estándar multiplicadas por la masa.\n\n“rowgreen” o “colgreen”: Los llamados biplots de contribución que muestran visualmente los puntos que más contribuyen (Greenacre 2006b).\n“rowgreen”: filas en coordenadas principales y columnas en coordenadas estándar multiplicadas por la raíz cuadrada de la masa.\n“colgreen”: columnas en coordenadas principales y filas en coordenadas estándar multiplicadas por la raíz cuadrada de la masa.\n\nEl siguiente código R dibuja un biplot asimétrico estándar:\n\n\nfviz_ca_biplot(res.ca,\n               map =\"rowprincipal\", arrow = c(TRUE, TRUE),\n               repel = TRUE)\n\n\n\n\nUsamos el argumento flechas, que es un vector de dos lógicas que especifican si la gráfica debe contener puntos (FALSE, predeterminado) o flechas (TRUE). El primer valor establece las filas y el segundo valor establece el columnas.\nSi el ángulo entre dos flechas es agudo, entonces existe una fuerte asociación entre la fila y la columna correspondientes.\nPara interpretar la distancia entre filas y una columna, debe proyectar perpendicularmente puntos de fila en la flecha de la columna.\nBiplot de contribución\nEn el biplot simétrico estándar (mencionado en la sección anterior), es difícil conocer los puntos que más contribuyen a la solución de la CA.\nMichael Greenacre propuso una nueva escala mostrada (llamada biplot de contribución) que incorpora la contribución de puntos (M. Greenacre 2013). En esta visualización, los puntos que contribuyen muy poco a la solución, están cerca del centro de la biplot y son relativamente poco importantes para la interpretación.\n\nSe puede dibujar un biplot de contribución usando el argumento map = \"rowgreen\" o map = \"colgreen\".\n\nEn primer lugar, hay que decidir si analizar las contribuciones de filas o columnas a la definición de los ejes.\nEn nuestro ejemplo interpretaremos la contribución de las filas a los ejes. Se utiliza el argumento map = \"colgreen\". En este caso, recuerde que las columnas están en coordenadas principales y las filas en coordenadas estándar multiplicadas por la raíz cuadrada de la masa. Para una fila dada, el cuadrado de la nueva coordenada en un eje i es exactamente la contribución de esta fila a la inercia del eje i.\n\n\nfviz_ca_biplot(res.ca, map =\"colgreen\", arrow = c(TRUE, FALSE),\n               repel = TRUE)\n\n\n\n\nEn el gráfico anterior, la posición de los puntos del perfil de la columna no cambia con respecto a la del biplot convencional. Sin embargo, las distancias de los puntos de fila desde el origen de la gráfica están relacionadas con sus contribuciones al mapa de factores bidimensionales.\nCuanto más cerca esté una flecha (en términos de distancia angular) de un eje, mayor será la contribución de la categoría de fila en ese eje en relación con el otro eje. Si la flecha está a medio camino entre los dos, su categoría de fila contribuye a los dos ejes en la misma medida.\n\nEs evidente que la categoría de fila Reparaciones (Repairs) tiene una contribución importante al polo positivo de la primera dimensión, mientras que las categorías Lavandería (Laundry) y Comida principal (Main_meal) tienen una contribución importante al polo negativo de la primera dimensión;\nLa dimensión 2 se define principalmente por la categoría de fila Vacaciones (Holidays).\nLa categoría de fila Conducción (Driving) contribuye a los dos ejes en la misma medida.\n\nDescripción de las dimensiones\nPara identificar fácilmente los puntos de fila y columna que están más asociados con las dimensiones principales, puede usar la función dimdesc() [en FactoMineR]. Las variables de fila/columna se ordenan por sus coordenadas en la salida dimdesc().\n\n\n# Descripción de la dimensión\nres.desc <- dimdesc(res.ca, axes = c(1,2))\n\n\n\nDescripción de la dimensión 1:\n\n\n# Descripción de la dimensión 1 por puntos de fila\nhead(res.desc[[1]]$row, 4)\n\n\n                coord\nLaundry    -0.9918368\nMain_meal  -0.8755855\nDinner     -0.6925740\nBreakfeast -0.5086002\n\n# Descripción de la dimensión 1 por puntos de columna\nhead(res.desc [[1]]$col, 4)\n\n\n                  coord\nWife        -0.83762154\nAlternating -0.06218462\nJointly      0.14942609\nHusband      1.16091847\n\nDescripción de la dimensión 2:\n\n\n# Descripción de la dimensión 2 por puntos de fila\nres.desc[[2]]$fila\n\n\nNULL\n\n# Descripción de la dimensión 1 por puntos de columna\nres.desc[[2]]$col\n\n\n                 coord\nJointly     -1.0265791\nAlternating  0.2915938\nWife         0.3652207\nHusband      0.6019199\n\n\n\n\n",
    "preview": "posts/2021-03-14-analiscorrespondencia/featured.png",
    "last_modified": "2021-03-14T17:13:29-04:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-14-tidyexam/",
    "title": "Ordenar datos con el paquete Tidyverse",
    "description": "Es un ejemplo de caso extraido del libro R4DS.",
    "author": [
      {
        "name": "Franklin Santos",
        "url": "https://franklinsantos.com"
      }
    ],
    "date": "2020-10-31",
    "categories": [
      "Data Science",
      "Tidy Data",
      "Tidyverse"
    ],
    "contents": "\nIntroducción\nLa ordenación de datos es una de las tareas mas importantes despues de concluir la investigación. En las ciencias agrícolas, generalmente la investigación concluye con la evaluación de la cosecha del cultivo. Generalmente nuestros datos pueden estar organizados en un libro de campo; sin embargo, en otras áreas no es así.\nEn este blog replicaré un ejemplo de ordenación de datos con el paquete Tidyverse del libro R4DS. El dataset datos::oms contiene datos de tuberculosis (TB) detallados por año, país, edad, sexo y método de diagnóstico. Los datos provienen del Informe de Tuberculosis de la Organización Mundial de la Salud 2014, disponible en http://www.who.int/tb/country/data/download/en/.\nProcedimiento de ordenación\nCargar el paquete tidyverse\nEl primer paso es instalar el paquete tidyverse del CRAN de R. Posterior a esto es cargar el paquete en nuestra consola de R.\n\n\nlibrary(tidyverse)\n#En el paquete datos se encuentra la base de datos para este ejemplo\nlibrary(datos)\n\n\n\nA continuación observación el estado de los datos de oms.\n\n\nhead(oms)\n\n\n# A tibble: 6 x 60\n  pais       iso2  iso3   anio nuevos_fpp_h014 nuevos_fpp_h1524\n  <chr>      <chr> <chr> <int>           <int>            <int>\n1 Afganistán AF    AFG    1980              NA               NA\n2 Afganistán AF    AFG    1981              NA               NA\n3 Afganistán AF    AFG    1982              NA               NA\n4 Afganistán AF    AFG    1983              NA               NA\n5 Afganistán AF    AFG    1984              NA               NA\n6 Afganistán AF    AFG    1985              NA               NA\n# … with 54 more variables: nuevos_fpp_h2534 <int>,\n#   nuevos_fpp_h3544 <int>, nuevos_fpp_h4554 <int>,\n#   nuevos_fpp_h5564 <int>, nuevos_fpp_h65 <int>,\n#   nuevos_fpp_m014 <int>, nuevos_fpp_m1524 <int>,\n#   nuevos_fpp_m2534 <int>, nuevos_fpp_m3544 <int>,\n#   nuevos_fpp_m4554 <int>, nuevos_fpp_m5564 <int>,\n#   nuevos_fpp_m65 <int>, nuevos_fpn_h014 <int>,\n#   nuevos_fpn_h1524 <int>, nuevos_fpn_h2534 <int>,\n#   nuevos_fpn_h3544 <int>, nuevos_fpn_h4554 <int>,\n#   nuevos_fpn_h5564 <int>, nuevos_fpn_h65 <int>,\n#   nuevos_fpn_m014 <int>, nuevos_fpn_m1524 <int>,\n#   nuevos_fpn_m2534 <int>, nuevos_fpn_m3544 <int>,\n#   nuevos_fpn_m4554 <int>, nuevos_fpn_m5564 <int>,\n#   nuevos_fpn_m65 <int>, nuevos_ep_h014 <int>,\n#   nuevos_ep_h1524 <int>, nuevos_ep_h2534 <int>,\n#   nuevos_ep_h3544 <int>, nuevos_ep_h4554 <int>,\n#   nuevos_ep_h5564 <int>, nuevos_ep_h65 <int>, nuevos_ep_m014 <int>,\n#   nuevos_ep_m1524 <int>, nuevos_ep_m2534 <int>,\n#   nuevos_ep_m3544 <int>, nuevos_ep_m4554 <int>,\n#   nuevos_ep_m5564 <int>, nuevos_ep_m65 <int>,\n#   nuevosrecaida_h014 <int>, nuevosrecaida_h1524 <int>,\n#   nuevosrecaida_h2534 <int>, nuevosrecaida_h3544 <int>,\n#   nuevosrecaida_h4554 <int>, nuevosrecaida_h5564 <int>,\n#   nuevosrecaida_h65 <int>, nuevosrecaida_m014 <int>,\n#   nuevosrecaida_m1524 <int>, nuevosrecaida_m2534 <int>,\n#   nuevosrecaida_m3544 <int>, nuevosrecaida_m4554 <int>,\n#   nuevosrecaida_m5564 <int>, nuevosrecaida_m65 <int>\n\nEn la salida se observa un ejemplo muy típico de una base de datos de la vida real. Contiene columnas redundantes, códigos extraños de variables y muchos valores faltantes. Practicamente, la base de datos oms está desordenado, por tanto, se necesita ordenarlo de manera sencilla con tidyverse.\nPasos de ordenación\nNecesitamos agrupar todas las columnas desde nuevos_fpp_h014 hasta recaidas_m65. No sabemos aún qué representa esto, por lo que le daremos el nombre genérico de \"clave\". Sabemos que las celdas representan la cuenta de casos, por lo que usaremos la variable casos.\nExisten múltiples valores faltantes en la representación actual, por lo que de momento usaremos na.rm para centrarnos en los valores que están presentes.\n\n\noms1 <- oms %>%\n  pivot_longer(\n    cols = nuevos_fpp_h014:nuevosrecaida_m65, \n    names_to = \"clave\", \n    values_to = \"casos\", \n    values_drop_na = TRUE\n  )\noms1\n\n\n# A tibble: 76,046 x 6\n   pais       iso2  iso3   anio clave            casos\n   <chr>      <chr> <chr> <int> <chr>            <int>\n 1 Afganistán AF    AFG    1997 nuevos_fpp_h014      0\n 2 Afganistán AF    AFG    1997 nuevos_fpp_h1524    10\n 3 Afganistán AF    AFG    1997 nuevos_fpp_h2534     6\n 4 Afganistán AF    AFG    1997 nuevos_fpp_h3544     3\n 5 Afganistán AF    AFG    1997 nuevos_fpp_h4554     5\n 6 Afganistán AF    AFG    1997 nuevos_fpp_h5564     2\n 7 Afganistán AF    AFG    1997 nuevos_fpp_h65       0\n 8 Afganistán AF    AFG    1997 nuevos_fpp_m014      5\n 9 Afganistán AF    AFG    1997 nuevos_fpp_m1524    38\n10 Afganistán AF    AFG    1997 nuevos_fpp_m2534    36\n# … with 76,036 more rows\n\nPara visualizar el conteo de valores en la nueva columna clave:\n\n\noms1 %>%\n  count(clave)\n\n\n# A tibble: 56 x 2\n   clave               n\n   <chr>           <int>\n 1 nuevos_ep_h014   1038\n 2 nuevos_ep_h1524  1026\n 3 nuevos_ep_h2534  1020\n 4 nuevos_ep_h3544  1024\n 5 nuevos_ep_h4554  1020\n 6 nuevos_ep_h5564  1015\n 7 nuevos_ep_h65    1018\n 8 nuevos_ep_m014   1032\n 9 nuevos_ep_m1524  1021\n10 nuevos_ep_m2534  1021\n# … with 46 more rows\n\nPara entender el significado de cada variable, se dispone de un diccionario de datos a mano. Este dice lo siguiente:\nLo que aparece antes del primer _ en las columnas indica si la columna contiene casos nuevos o antiguos de tuberculosis. En este dataset, cada columna contiene nuevos casos.\nLo que aparece luego de indicar si se refiere casos nuevos o antiguos es el tipo de tuberculosis:\nrecaida se refiere a casos reincidentes\nep se refiere a tuberculosis extra pulmonar\nfpn se refiere a casos de tuberculosis pulmonar que no se pueden detectar mediante examen de frotis pulmonar (frotis pulmonar negativo)\nfpp se refiere a casos de tuberculosis pulmonar que se pueden detectar mediante examen de frotis pulmonar (frotis pulmonar positivo)\nLa letra que aparece después del último _ se refiere al sexo de los pacientes. El conjunto de datos agrupa en hombres (h) y mujeres (m).\nLos números finales se refieren al grupo etareo que se ha organizado en siete categorías:\n014 = 0 - 14 años de edad\n1524 = 15 – 24 años de edad\n2534 = 25 – 34 años de edad\n3544 = 35 – 44 años de edad\n4554 = 45 – 54 años de edad\n5564 = 55 – 64 años de edad\n65 = 65 o más años de edad\nNecesitamos hacer un pequeño cambio al formato de los nombres de las columnas: desafortunadamente lo nombres de las columnas son ligeramente inconsistentes debido a que en lugar de nuevos_recaida tenemos nuevosrecaida (es difícil darse cuenta de esto en esta parte, pero si no lo arreglas habrá errores en los pasos siguientes). Para esto, la idea básica es bastante simple: reemplazar los caracteres “nuevosrecaida” por “nuevos_recaida”. Esto genera nombres de variables consistentes.\n\n\noms2 <- oms1 %>%\n  mutate(clave = stringr::str_replace(clave, \"nuevosrecaida\", \"nuevos_recaida\"))\noms2\n\n\n# A tibble: 76,046 x 6\n   pais       iso2  iso3   anio clave            casos\n   <chr>      <chr> <chr> <int> <chr>            <int>\n 1 Afganistán AF    AFG    1997 nuevos_fpp_h014      0\n 2 Afganistán AF    AFG    1997 nuevos_fpp_h1524    10\n 3 Afganistán AF    AFG    1997 nuevos_fpp_h2534     6\n 4 Afganistán AF    AFG    1997 nuevos_fpp_h3544     3\n 5 Afganistán AF    AFG    1997 nuevos_fpp_h4554     5\n 6 Afganistán AF    AFG    1997 nuevos_fpp_h5564     2\n 7 Afganistán AF    AFG    1997 nuevos_fpp_h65       0\n 8 Afganistán AF    AFG    1997 nuevos_fpp_m014      5\n 9 Afganistán AF    AFG    1997 nuevos_fpp_m1524    38\n10 Afganistán AF    AFG    1997 nuevos_fpp_m2534    36\n# … with 76,036 more rows\n\nUna vez reemplazado, nos facilita separar los valores en cada código aplicando separate() dos veces. La primera aplicación dividirá los códigos en cada _.\n\n\noms3 <- oms2 %>%\n  separate(clave, c(\"nuevos\", \"tipo\", \"sexo_edad\"), sep = \"_\")\noms3\n\n\n# A tibble: 76,046 x 8\n   pais       iso2  iso3   anio nuevos tipo  sexo_edad casos\n   <chr>      <chr> <chr> <int> <chr>  <chr> <chr>     <int>\n 1 Afganistán AF    AFG    1997 nuevos fpp   h014          0\n 2 Afganistán AF    AFG    1997 nuevos fpp   h1524        10\n 3 Afganistán AF    AFG    1997 nuevos fpp   h2534         6\n 4 Afganistán AF    AFG    1997 nuevos fpp   h3544         3\n 5 Afganistán AF    AFG    1997 nuevos fpp   h4554         5\n 6 Afganistán AF    AFG    1997 nuevos fpp   h5564         2\n 7 Afganistán AF    AFG    1997 nuevos fpp   h65           0\n 8 Afganistán AF    AFG    1997 nuevos fpp   m014          5\n 9 Afganistán AF    AFG    1997 nuevos fpp   m1524        38\n10 Afganistán AF    AFG    1997 nuevos fpp   m2534        36\n# … with 76,036 more rows\n\nA continuación podemos eliminar la columna nuevos, ya que es constante en este dataset. Además eliminaremos iso2 e iso3 ya que son redundantes.\n\n\noms3 %>%\n  count(nuevos)\n\n\n# A tibble: 1 x 2\n  nuevos     n\n  <chr>  <int>\n1 nuevos 76046\n\noms4 <- oms3 %>%\n  select(-nuevos, -iso2, -iso3)\n\n\n\nLuego separamos sexo_edad en sexo y edad dividiendo luego del primer carácter:\n\n\noms5 <- oms4 %>%\n  separate(sexo_edad, c(\"sexo\", \"edad\"), sep = 1)\noms5\n\n\n# A tibble: 76,046 x 6\n   pais        anio tipo  sexo  edad  casos\n   <chr>      <int> <chr> <chr> <chr> <int>\n 1 Afganistán  1997 fpp   h     014       0\n 2 Afganistán  1997 fpp   h     1524     10\n 3 Afganistán  1997 fpp   h     2534      6\n 4 Afganistán  1997 fpp   h     3544      3\n 5 Afganistán  1997 fpp   h     4554      5\n 6 Afganistán  1997 fpp   h     5564      2\n 7 Afganistán  1997 fpp   h     65        0\n 8 Afganistán  1997 fpp   m     014       5\n 9 Afganistán  1997 fpp   m     1524     38\n10 Afganistán  1997 fpp   m     2534     36\n# … with 76,036 more rows\n\n¡Ahora la base de datos oms está ordenado!\nResumen\nEn la anterior sección se hizo el procedimiento de ordenación paso a paso, asignando los resultados intermedios a nuevas variables. Esta no es la forma típica de trabajo. En realidad, los códigos debería ser de manera incremental usando pipes (\"%>%):\n\n\nfsdata<- oms %>%\n  pivot_longer(\n    cols = nuevos_fpp_h014:nuevosrecaida_m65,\n    names_to = \"clave\", \n    values_to = \"valor\", \n    values_drop_na = TRUE) %>%\n  mutate(clave = stringr::str_replace(clave, \"nuevosrecaida\", \"nuevos_recaida\")) %>%\n  separate(clave, c(\"nuevos\", \"tipo\", \"sexo_edad\")) %>%\n  select(-nuevos, -iso2, -iso3) %>%\n  separate(sexo_edad, c(\"sexo\", \"edad\"), sep = 1)\nfsdata\n\n\n# A tibble: 76,046 x 6\n   pais        anio tipo  sexo  edad  valor\n   <chr>      <int> <chr> <chr> <chr> <int>\n 1 Afganistán  1997 fpp   h     014       0\n 2 Afganistán  1997 fpp   h     1524     10\n 3 Afganistán  1997 fpp   h     2534      6\n 4 Afganistán  1997 fpp   h     3544      3\n 5 Afganistán  1997 fpp   h     4554      5\n 6 Afganistán  1997 fpp   h     5564      2\n 7 Afganistán  1997 fpp   h     65        0\n 8 Afganistán  1997 fpp   m     014       5\n 9 Afganistán  1997 fpp   m     1524     38\n10 Afganistán  1997 fpp   m     2534     36\n# … with 76,036 more rows\n\nConclusión\nEs un ejemplo muy bueno para practicar y usar las diferentes funciones de tidyverse en la ordenación de datos.\n\n\n\n",
    "preview": "posts/2021-03-14-tidyexam/featured.png",
    "last_modified": "2021-03-14T16:31:00-04:00",
    "input_file": {}
  }
]

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>R for Excel Users (Part 2: readxl package)</title>

  <meta property="description" itemprop="description" content="The read_excel() function provides an efficient solution to read Excel worksheets as tibbles."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-07-03"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-07-03"/>
  <meta name="article:author" content="Franklin Santos"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="R for Excel Users (Part 2: readxl package)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="The read_excel() function provides an efficient solution to read Excel worksheets as tibbles."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="R for Excel Users (Part 2: readxl package)"/>
  <meta property="twitter:description" content="The read_excel() function provides an efficient solution to read Excel worksheets as tibbles."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","preview","output"]}},"value":[{"type":"character","attributes":{},"value":["R for Excel Users (Part 2: readxl package)"]},{"type":"character","attributes":{},"value":["The read_excel() function provides an efficient solution to read Excel worksheets as tibbles.\n"]},{"type":"character","attributes":{},"value":["Data Science","readxl","R"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Franklin Santos"]},{"type":"character","attributes":{},"value":["https://franklinsantos.com"]},{"type":"character","attributes":{},"value":["National Institute for Agricultural and Forestry Innovation (INIAF)"]},{"type":"character","attributes":{},"value":["0000-0002-7509-2910"]}]}]},{"type":"character","attributes":{},"value":["2022-07-03"]},{"type":"character","attributes":{},"value":["logo.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["a.png","b.png","c.png","customers_title.xlsx","customers.xlsx","d.png","e.png","excel-part2_files/anchor-4.2.2/anchor.min.js","excel-part2_files/bowser-1.9.3/bowser.min.js","excel-part2_files/distill-2.2.21/template.v2.js","excel-part2_files/header-attrs-2.14/header-attrs.js","excel-part2_files/jquery-3.6.0/jquery-3.6.0.js","excel-part2_files/jquery-3.6.0/jquery-3.6.0.min.js","excel-part2_files/jquery-3.6.0/jquery-3.6.0.min.map","excel-part2_files/popper-2.6.0/popper.min.js","excel-part2_files/tippy-6.2.7/tippy-bundle.umd.min.js","excel-part2_files/tippy-6.2.7/tippy-light-border.css","excel-part2_files/tippy-6.2.7/tippy.css","excel-part2_files/tippy-6.2.7/tippy.umd.min.js","excel-part2_files/webcomponents-2.0.0/webcomponents.js","logo.png","online_shop.xlsx","orders.xlsx","products.xlsx","sales.xlsx"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="excel-part2_files/header-attrs-2.16/header-attrs.js"></script>
  <script src="excel-part2_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="excel-part2_files/popper-2.6.0/popper.min.js"></script>
  <link href="excel-part2_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="excel-part2_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="excel-part2_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="excel-part2_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="excel-part2_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="excel-part2_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="excel-part2_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"R for Excel Users (Part 2: readxl package)","description":"The read_excel() function provides an efficient solution to read Excel worksheets as tibbles.","authors":[{"author":"Franklin Santos","authorURL":"https://franklinsantos.com","affiliation":"National Institute for Agricultural and Forestry Innovation (INIAF)","affiliationURL":"#","orcidID":"0000-0002-7509-2910"}],"publishedDate":"2022-07-03T00:00:00.000-04:00","citationText":"Santos, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>R for Excel Users (Part 2: readxl package)</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">Data Science</div>
<div class="dt-tag">readxl</div>
<div class="dt-tag">R</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>The read_excel() function provides an efficient solution to read Excel worksheets as tibbles.</p></p>
</div>

<div class="d-byline">
  Franklin Santos <a href="https://franklinsantos.com" class="uri">https://franklinsantos.com</a> (National Institute for Agricultural and Forestry Innovation (INIAF))
  
<br/>2022-07-03
</div>

<div class="d-article">
<style>
body {
text-align: justify}
</style>
<h1 id="load-excel-files-as-data-frames">Load Excel Files as Data Frames</h1>
<p>The <span style="color: green; ">read_excel()</span> function provides an efficient solution to read Excel worksheets as tibbles. It is well integrated into the <strong>RStudio</strong> editor to make data imports from Excel even easier.</p>
<ul>
<li>Read Excel worksheets with <span style="color: green; ">read_excel()</span></li>
<li>Get familiar with the default settings of <span style="color: green; ">read_excel()</span></li>
<li>Use the <span style="color: green; ">skip</span> argument to ignore title rows</li>
<li>Use the <span style="color: green; ">col_names</span> argument to handle column names</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;&lt;filename.xlsx&gt;&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> ___,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> ___)</span></code></pre></div>
</div>
<h2 id="introduction">Introduction</h2>
<p>The <span style="color: green; ">read_excel()</span> function from the <em>readxl</em> package probably provides the quickest and most convenient way to read Excel files with R. It can be used for either the <span style="color: green; ">.xlsx</span> or the (old) <span style="color: green; ">.xls</span> file extensions and handles each file format accordingly. In addition, the function sets column names, data types and missing values automatically.</p>
<p>Excel file imports through <em>readxl</em> are also directly integrated into the RStudio development environment by just clicking on the file in the <em>Files</em> pane:</p>
<p><img src="a.png" /></p>
<p>For these reasons, <span style="color: green; ">read_excel()</span> is one of the most widely used functions for Excel file imports.</p>
<h2 id="the-read_excel-function">The read_excel() Function</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;&lt;filename.xlsx&gt;&quot;</span>,</span></code></pre></div>
</div>
<p>After loading the <em>readxl</em> package we can read our first excel file by calling the <span style="color: blue; ">read_excel()</span> with the <span style="color: blue; ">path</span> to the document we want to read. As an output, <span style="color: blue; ">read_excel()</span> returns the contents of the spreadsheet as a tibble.</p>
<p>In the following example, we read the Excel file <span style="color: darkred; ">orders.xlsx</span>, containing information about the orders received by an online shop:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"orders.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 5
   OrderID CustID TotalPrice Payment     Status   
     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    
 1       1 C1             35 Credit Card Delivered
 2       2 C2             30 Debit Card  Delivered
 3       3 C4             50 Paypal      Delivered
 4       4 C3             13 Credit Card Returned 
 5       5 C5             63 Paypal      Delivered
 6       6 C6             20 Debit Card  Delivered
 7       7 C7             13 Paypal      Delivered
 8       8 C3             50 Debit Card  Returned 
 9       9 C8             13 Credit Card Delivered
10      10 C4             40 Debit Card  Delivered</code></pre>
</div>
<h2 id="spreadsheet-shape">Spreadsheet Shape</h2>
<p>Excel spreadsheets can come in many forms with different layouts. In an optimal case the contents of a spreadsheet are organized in a tabular format with the first row defining the name of each column. Based on these principles, by default the <span style="color: blue; ">read_excel()</span> function will:</p>
<ul>
<li>read the smallest possible rectangular area from the spreadsheet that covers all non-empty cells.</li>
<li>use the first row of content as column names for the output.</li>
<li>handle empty cells as <span style="color: red; ">NA</span> values.</li>
</ul>
<p>As an example, let’s take a look at the structure of the following spreadsheet:</p>
<p><img src="b.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"products.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 4
  ItemID Description    UnitPrice Stock
  &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;
1 I1     Socks (2 Pair)      13.0    25
2 I2     Sweatshirt          40.0    42
3 &lt;NA&gt;   &lt;NA&gt;                NA      NA
4 I4     Caps                15.0    30
5 I5     Pants               50.0    23</code></pre>
</div>
<h2 id="data-types">Data Types</h2>
<p>Apart from automatically finding the relevant area of cells, <span style="color: blue; ">read_excel()</span> will also infer the data types of the columns based on the used Excel data types. Even if different formatting options have been used for numeric values like currencies and percentages <span style="color: blue; ">read_excel()</span> will still interpret them as numeric. This would not be the case for manually typed (string) percentage values since they change the Excel cell type to string and thus are interpreted as characters.</p>
<p>As an example, let’s take a look at the following spreadsheet:</p>
<p><img src="c.png" />
If we read this file using <span style="color: blue; ">read_excel()</span>, each column is assigned to the most suitable data type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"customers.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 7
   CustID FirstName LastName Email              Newsl…¹ Orders Spend…²
   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;              &lt;lgl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 C1     Lisa      Rogers   lisa.rogers@email… TRUE         2    98.0
 2 C2     Mark      Harrison mark.harrison@ema… FALSE        1    30.0
 3 C3     Robert    Adams    robert.adams@emai… TRUE         3    78.0
 4 C4     Emily     Jenkins  emily.jenkins@ema… FALSE        2    90.0
 5 C5     Sarah     Hunter   sarah.hunter@emai… FALSE        1    63.0
 6 C6     Michael   Mason    michael.mason@ema… TRUE         1    20.0
 7 C7     Ryan      Lane     ryan.lane@email.c… FALSE        2    26.0
 8 C8     Megan     Cole     megan.cole@email.… TRUE         1    13.0
 9 C9     Daniel    Stone    daniel.stone@emai… FALSE        1    50.0
10 C10    Hannah    Edwards  hannah.edwards@em… TRUE         1    60.0
# … with abbreviated variable names ¹​Newsletter, ²​Spending</code></pre>
</div>
<p>Note, that <span style="color: blue; ">read_excel()</span> cannot automatically identify, whether a column represents a factor variable and instead interprets it as a character. These columns must be manually converted with <span style="color: blue; ">factor()</span> after a spreadsheet has been read.</p>
<h2 id="optional-argument-skip">Optional Argument: <span style="color: blue; "><em>skip</em></span></h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;&lt;filename.xlsx&gt;&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> ___,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> ___)</span></code></pre></div>
</div>
<p>Excel files often contain header rows at the beginning of the spreadsheets which shall not be part of the table to be read. For example, the file <span style="color: blue; ">customers_title.xlsx</span> has the following layout:</p>
<p><img src="d.png" />
Reading it with a vanilla <span style="color: blue; ">read_excel()</span> function results in</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"customers_title.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 11 × 7
   `Customer Database` ...2      ...3     ...4       ...5  ...6  ...7 
   &lt;chr&gt;               &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 CustID              FirstName LastName Email      News… Orde… Spen…
 2 C1                  Lisa      Rogers   lisa.roge… TRUE  2     97.96
 3 C2                  Mark      Harrison mark.harr… FALSE 1     29.98
 4 C3                  Robert    Adams    robert.ad… TRUE  3     77.97
 5 C4                  Emily     Jenkins  emily.jen… FALSE 2     89.97
 6 C5                  Sarah     Hunter   sarah.hun… FALSE 1     62.98
 7 C6                  Michael   Mason    michael.m… TRUE  1     19.9…
 8 C7                  Ryan      Lane     ryan.lane… FALSE 2     25.98
 9 C8                  Megan     Cole     megan.col… TRUE  1     12.99
10 C9                  Daniel    Stone    daniel.st… FALSE 1     49.99
11 C10                 Hannah    Edwards  hannah.ed… TRUE  1     59.97</code></pre>
</div>
<p>To exclude the first row containing <span style="color: blue; ">Customer Database</span> we can use the <span style="color:red;">skip</span> parameter and define the exact number of rows to be skipped at the beginning of the spreadsheet:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"customers_title.xlsx"</span>, skip <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 7
   CustID FirstName LastName Email              Newsl…¹ Orders Spend…²
   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;              &lt;lgl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 C1     Lisa      Rogers   lisa.rogers@email… TRUE         2    98.0
 2 C2     Mark      Harrison mark.harrison@ema… FALSE        1    30.0
 3 C3     Robert    Adams    robert.adams@emai… TRUE         3    78.0
 4 C4     Emily     Jenkins  emily.jenkins@ema… FALSE        2    90.0
 5 C5     Sarah     Hunter   sarah.hunter@emai… FALSE        1    63.0
 6 C6     Michael   Mason    michael.mason@ema… TRUE         1    20.0
 7 C7     Ryan      Lane     ryan.lane@email.c… FALSE        2    26.0
 8 C8     Megan     Cole     megan.cole@email.… TRUE         1    13.0
 9 C9     Daniel    Stone    daniel.stone@emai… FALSE        1    50.0
10 C10    Hannah    Edwards  hannah.edwards@em… TRUE         1    60.0
# … with abbreviated variable names ¹​Newsletter, ²​Spending</code></pre>
</div>
<h2 id="optional-argument-col_names">Optional Argument: <span style="color: blue; "><em>col_names</em></span></h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;&lt;filename.xlsx&gt;&quot;</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> ___,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> ___)</span></code></pre></div>
</div>
<p>Another frequent issue is the use of common titles instead of separate names for each column:</p>
<p><img src="e.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"sales.xlsx"</span>,</span>
<span>           skip <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           col_names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 2
  ...1            ...2
  &lt;chr&gt;          &lt;dbl&gt;
1 Socks (2 Pair)     3
2 Sweatshirt         3
3 T-Shirt            7
4 Caps               4
5 Pants              5</code></pre>
</div>
<p>In case you know the appropriate column names, it is also possible to define a character vector with the desired names:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"sales.xlsx"</span>,</span>
<span>           skip <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           col_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Item"</span>, <span class='st'>"UnitsSold"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 2
  Item           UnitsSold
  &lt;chr&gt;              &lt;dbl&gt;
1 Socks (2 Pair)         3
2 Sweatshirt             3
3 T-Shirt                7
4 Caps                   4
5 Pants                  5</code></pre>
</div>
<h1 id="handle-excel-files-with-multiple-sheets">Handle Excel Files with Multiple Sheets</h1>
<p>The <span style="color: blue; ">read_excel()</span> function can only read one Excel sheet at a time. However, Excel files often contain multiple worksheets. In these cases, we can rely on the <span style="color: blue; ">excel_sheets()</span> function to inspect the available worksheets and instruct <span style="color: blue; ">read_excel()</span> to read the appropriate one.</p>
<ul>
<li>Use <span style="color: blue; ">excel_sheets()</span> to retrieve all sheet names from an Excel file</li>
<li>Use the <span style="color: green; ">sheet</span> parameter in <span style="color: blue; ">read_excel()</span> to read a specific worksheet</li>
<li>Read all worksheets using an <span style="color: blue; ">sapply()</span> loop</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sheets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/excel_sheets.html'>excel_sheets</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"&lt;sheetname&gt;"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>sheets</span>, FUN <span class='op'>=</span> <span class='va'>readxl</span>, path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="inspect-the-available-excel-sheets">Inspect the Available Excel Sheets</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sheets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/excel_sheets.html'>excel_sheets</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span><span class='op'>)</span></span>
<span><span class='co'>#read_excel(path = "&lt;filename.xlsx&gt;",</span></span>
<span><span class='co'>#          sheet = "&lt;sheetname&gt;")</span></span>
<span><span class='co'>#sapply(X = sheets, FUN = readxl, path = "&lt;filename.xlsx&gt;")</span></span></code></pre>
</div>
</div>
<p>Excel files often contain multiple spreadsheets. These must have unique names in order to make an exact identification and selection possible. In the world of <em>readxl</em>, we can use the <span style="color: blue; ">excel_sheets()</span> function to inspect the available spreadsheets in an Excel file. As an output it returns a character vector with their names:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://readxl.tidyverse.org/reference/excel_sheets.html'>excel_sheets</a></span><span class='op'>(</span><span class='st'>"online_shop.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;Customers&quot; &quot;Products&quot;  &quot;Orders&quot;   </code></pre>
</div>
<h2 id="read-a-specific-sheet">Read a Specific Sheet</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#sheets &lt;- excel_sheets(path = "&lt;filename.xlsx&gt;")</span></span>
<span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"&lt;sheetname&gt;"</span><span class='op'>)</span></span>
<span><span class='co'>#sapply(X = sheets, FUN = readxl, path = "&lt;filename.xlsx&gt;")</span></span></code></pre>
</div>
</div>
<p>Once we know which worksheet we want to read from an Excel file, we have two options. We can either use the name of the worksheet and define it as the sheet parameter:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"Orders"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 5
   OrderID CustID TotalPrice Payment     Status   
     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    
 1       1 C1             35 Credit Card Delivered
 2       2 C2             30 Debit Card  Delivered
 3       3 C4             50 Paypal      Delivered
 4       4 C3             13 Credit Card Returned 
 5       5 C5             63 Paypal      Delivered
 6       6 C6             20 Debit Card  Delivered
 7       7 C7             13 Paypal      Delivered
 8       8 C3             50 Debit Card  Returned 
 9       9 C8             13 Credit Card Delivered
10      10 C4             40 Debit Card  Delivered</code></pre>
</div>
<p>Alternatively, we can use the index of the worksheet within the Excel file:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 5
   OrderID CustID TotalPrice Payment     Status   
     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    
 1       1 C1             35 Credit Card Delivered
 2       2 C2             30 Debit Card  Delivered
 3       3 C4             50 Paypal      Delivered
 4       4 C3             13 Credit Card Returned 
 5       5 C5             63 Paypal      Delivered
 6       6 C6             20 Debit Card  Delivered
 7       7 C7             13 Paypal      Delivered
 8       8 C3             50 Debit Card  Returned 
 9       9 C8             13 Credit Card Delivered
10      10 C4             40 Debit Card  Delivered</code></pre>
</div>
<h2 id="read-all-sheets-using-sapply">Read All Sheets Using <span style="color: blue; "><em>sapply()</em></span></h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#sheets &lt;- excel_sheets(path = "&lt;filename.xlsx&gt;")</span></span>
<span><span class='co'>#read_excel(path = "&lt;filename.xlsx&gt;",</span></span>
<span> <span class='co'>#          sheet = "&lt;sheetname&gt;")</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>sheets</span>, FUN <span class='op'>=</span> <span class='va'>readxl</span>, path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In case we want to read all available worksheets from an Excel file, we can make use of a simple loop structure. First we extract the names of the worksheets:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sheets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/excel_sheets.html'>excel_sheets</a></span><span class='op'>(</span><span class='st'>"online_shop.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next we use <span style="color: blue; ">sapply()</span> to interactively read each spreadsheet and return a list containing the spreadsheet table contents as items. For each iteration, <span style="color: blue; "><em>sapply</em></span> uses a worksheet name from <span style="color: blue; "><em>sheets</em></span> and reads it through <span style="color: blue; ">read_excel()</span>. To make this possible we also need to define the path to the Excel file:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>collection</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>sheets</span>,</span>
<span>                     FUN <span class='op'>=</span> <span class='va'>read_excel</span>,</span>
<span>                     path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>As a result, <span style="color: blue; ">sapply()</span> will return a list of tibbles containing data from all spreadsheets. Afterwards, we can simply select a spreadsheet from the list:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>collection</span><span class='op'>$</span><span class='va'>Customers</span></span></code></pre>
</div>
<pre><code># A tibble: 10 × 7
   CustID FirstName LastName Email              Newsl…¹ Orders Spend…²
   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;              &lt;lgl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 C1     Lisa      Rogers   lisa.rogers@email… TRUE         2    98.0
 2 C2     Mark      Harrison mark.harrison@ema… FALSE        1    30.0
 3 C3     Robert    Adams    robert.adams@emai… TRUE         3    78.0
 4 C4     Emily     Jenkins  emily.jenkins@ema… FALSE        2    90.0
 5 C5     Sarah     Hunter   sarah.hunter@emai… FALSE        1    63.0
 6 C6     Michael   Mason    michael.mason@ema… TRUE         1    20.0
 7 C7     Ryan      Lane     ryan.lane@email.c… FALSE        2    26.0
 8 C8     Megan     Cole     megan.cole@email.… TRUE         1    13.0
 9 C9     Daniel    Stone    daniel.stone@emai… FALSE        1    50.0
10 C10    Hannah    Edwards  hannah.edwards@em… TRUE         1    60.0
# … with abbreviated variable names ¹​Newsletter, ²​Spending</code></pre>
</div>
<p>Note, that this approach makes it harder to handle individual issues of the spreadsheets and define different <span style="color: blue; ">skip</span> or <span style="color: blue; ">col_names</span> settings for example.</p>
<h1 id="read-a-specific-range-from-an-excel-sheet">Read a Specific Range from an Excel Sheet</h1>
<p>Excel sheets can contain vast amounts of information, out of which we might only require a specific set of rows and columns. The <span style="color: blue; ">read_excel()</span> function has a <span style="color: red; ">range</span> parameter to restrict data input to a specific range of cells.</p>
<ul>
<li>Read only a range of cells using the <span style="color: red; ">range</span> argument</li>
<li>Apply selector functions to read a range of rows or columns</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"&lt;filename.xlsx&gt;"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"&lt;sheetname&gt;"</span>,</span>
<span>           range <span class='op'>=</span> <span class='st'>"&lt;start&gt;:&lt;end&gt;"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="define-a-range-selection">Define a Range Selection</h2>
<p>In addition to selecting a specific sheet, we can extend the <span style="color: blue; ">read_excel()</span> function with the <span style="color: red; ">range</span> parameter to read only a given range of cells. Ranges need to be specified using the typical Excel format, defining a rectangular area of cells.</p>
<p><img src="c.png" /></p>
<p>For example, to read the first six rows in column <strong>B</strong> and <strong>C</strong> from the Excel file <em>online_shop.xlsx</em> we can use</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"Products"</span>,</span>
<span>           range <span class='op'>=</span> <span class='st'>"B1:C6"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 2
  Description    UnitPrice       
  &lt;chr&gt;          &lt;chr&gt;           
1 Socks (2 Pair)  €        12,99 
2 Sweatshirt      €        39,99 
3 &lt;NA&gt;           &lt;NA&gt;            
4 Caps            €        14,99 
5 Pants           €        49,99 </code></pre>
</div>
<p>Note that defining a specific <span style="color: red; ">range</span> will overwrite settings such as <span style="color: red; ">skip</span>. It will read exclusively the area defined by <span style="color: red; ">range</span>, no matter if it contains any content.</p>
<h2 id="use-range-selector-functions">Use Range Selector Functions</h2>
<p>Reading a range of rows or columns from an Excel worksheet can be tedious when using an exact cell range definition. We need to know how many rows there are or how many columns there are in order to properly define the range. As a more convenient alternative, we can apply specific selector functions that automatically find all columns for a selection of rows and all observations belonging to a selection of columns.</p>
<p>To read only the first 4 rows, we can use the <span style="color: blue; ">cell_rows()</span> selector function to define the <span style="color: red; ">range</span> of interest:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"Products"</span>,</span>
<span>           range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/cellranger/man/cell_rows.html'>cell_rows</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 3 × 4
  ItemID Description    UnitPrice        Stock
  &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt;            &lt;dbl&gt;
1 I1     Socks (2 Pair)  €        12,99     25
2 I2     Sweatshirt      €        39,99     42
3 &lt;NA&gt;   &lt;NA&gt;           &lt;NA&gt;                NA</code></pre>
</div>
<p>Similarly, to read only the first 2 columns, we can apply the <span style="color: blue; ">cell_cols()</span> selector function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"online_shop.xlsx"</span>,</span>
<span>           sheet <span class='op'>=</span> <span class='st'>"Products"</span>,</span>
<span>           range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/cellranger/man/cell_cols.html'>cell_cols</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 2
  ItemID Description   
  &lt;chr&gt;  &lt;chr&gt;         
1 I1     Socks (2 Pair)
2 I2     Sweatshirt    
3 &lt;NA&gt;   &lt;NA&gt;          
4 I4     Caps          
5 I5     Pants         </code></pre>
</div>
<blockquote>
<p>Coming up <span style="color: green; ">writexl</span> package…</p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
